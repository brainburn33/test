name: Upload to MEGA

on:
  workflow_dispatch:

jobs:
  upload:
    runs-on: windows-latest
    steps:
      - name: Install MEGAcmd
        shell: powershell
        run: |
          Invoke-WebRequest https://mega.nz/MEGAcmdSetup64.exe -OutFile mega.exe
          Start-Process mega.exe -ArgumentList "/S" -Wait

      - name: Login to MEGA
        shell: powershell
        run: |
          & "C:\Program Files\MEGAcmd\mega-login.bat" "${{ secrets.MEGA_EMAIL }}" "${{ secrets.MEGA_PASSWORD }}"

      - name: Upload file
        shell: powershell
        run: |
          "Test file" | Out-File test.txt
          & "C:\Program Files\MEGAcmd\mega-put.bat" test.txt /GitHub-Actions/
